---
import Layout from '../../layouts/Layout.astro';
import { getCollection } from 'astro:content';

export async function getStaticPaths() {
	const pieces = await getCollection('art');
	return pieces.map((piece) => ({
		params: { slug: piece.slug },
		props: { piece },
	}));
}

const { piece } = Astro.props;
const { Content } = await piece.render();
---

<Layout title={`${piece.data.title} | Art`} description={`Artwork: ${piece.data.title}`}>
	<main class="mx-auto max-w-4xl px-6 py-14 lg:py-20">
		<a class="text-sm text-slate-500 underline-offset-4 hover:underline dark:text-slate-400" href="/art">
			‚Üê Back to gallery
		</a>
		<header class="mt-4 flex flex-col gap-3 sm:flex-row sm:items-end sm:justify-between">
			<div>
				<p class="text-sm uppercase tracking-[0.2em] text-slate-500 dark:text-slate-400">Art</p>
				<h1 class="mt-2 text-3xl font-semibold leading-tight sm:text-4xl">{piece.data.title}</h1>
				{piece.data.year && (
					<p class="mt-1 text-sm text-slate-500 dark:text-slate-400">{piece.data.year}</p>
				)}
			</div>
			<div class="flex flex-wrap gap-2 text-xs">
				{piece.data.tools?.map((tool) => (
					<span class="pill border-none bg-slate-100/80 px-2 py-0.5 text-[11px] text-slate-700 dark:bg-slate-800/80 dark:text-slate-200">
						{tool}
					</span>
				))}
			</div>
		</header>

		<section class="mt-8 space-y-8">
			<div class="card overflow-hidden">
				<div class="relative bg-slate-900/90">
					{piece.data.image && (
						<img
							src={piece.data.image}
							alt={piece.data.title}
							loading="lazy"
							class="mx-auto max-h-[560px] w-full object-contain object-center bg-slate-900"
						/>
					)}
					{!piece.data.image && (
						<div class="flex h-64 items-center justify-center text-sm text-slate-400">
							Add an image path in the frontmatter to display artwork here.
						</div>
					)}
				</div>
			</div>

			<div class="prose prose-slate max-w-none dark:prose-invert">
				<Content />
			</div>

			{piece.data.tags?.length && (
				<div class="flex flex-wrap gap-2 text-xs text-slate-500 dark:text-slate-400">
					{piece.data.tags.map((tag) => (
						<span class="pill border-none bg-slate-100/80 px-2 py-0.5 text-[11px] text-slate-700 dark:bg-slate-800/80 dark:text-slate-200">
							{tag}
						</span>
					))}
				</div>
			)}
		</section>
	</main>
</Layout>
